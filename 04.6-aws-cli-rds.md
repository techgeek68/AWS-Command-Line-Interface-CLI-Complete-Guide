# AWS CLI â€“ RDS Guide

## Table of Contents
1. [Overview](#overview)
2. [Listing Instances](#1-listing-instances)
3. [Snapshots](#2-snapshots)
4. [Starting / Stopping](#3-start--stop-supported-engines)
5. [Parameter Groups](#4-parameter-groups)
6. [Modifying Instances](#5-modifying-instances)
7. [Best Practices](#6-best-practices)
8. [Troubleshooting](#7-troubleshooting)

---

## Overview
Amazon RDS provides managed relational databases. The CLI is used for instance enumeration, snapshots, parameter groups, and limited lifecycle tasks (create/modify/delete). Some engines allow start/stop for cost optimization.

---

## 1. Listing Instances
```bash
aws rds describe-db-instances
```

Endpoints + ports:
```bash
aws rds describe-db-instances \
  --query "DBInstances[].{DB:DBInstanceIdentifier,Endpoint:Endpoint.Address,Port:Endpoint.Port}" \
  --output table
```

---

## 2. Snapshots
Create:
```bash
aws rds create-db-snapshot \
  --db-instance-identifier mydb \
  --db-snapshot-identifier mydb-snap-20250822
```

List:
```bash
aws rds describe-db-snapshots --db-instance-identifier mydb
```

Restore:
```bash
aws rds restore-db-instance-from-db-snapshot \
  --db-instance-identifier mydb-restore \
  --db-snapshot-identifier mydb-snap-20250822
```

Delete snapshot:
```bash
aws rds delete-db-snapshot --db-snapshot-identifier mydb-snap-20250822
```

---

## 3. Start / Stop (Supported Engines)
Stop:
```bash
aws rds stop-db-instance --db-instance-identifier mydb
```
Start:
```bash
aws rds start-db-instance --db-instance-identifier mydb
```

---

## 4. Parameter Groups
List groups:
```bash
aws rds describe-db-parameter-groups
```

Describe parameters:
```bash
aws rds describe-db-parameters --db-parameter-group-name default.mysql8.0 --max-items 20
```

Modify (custom group):
```bash
aws rds modify-db-parameter-group \
  --db-parameter-group-name custom-mysql8 \
  --parameters "ParameterName=slow_query_log,ParameterValue=1,ApplyMethod=pending-reboot"
```

---

## 5. Modifying Instances
Scale class:
```bash
aws rds modify-db-instance \
  --db-instance-identifier mydb \
  --db-instance-class db.t4g.medium \
  --apply-immediately
```

Storage autoscaling:
```bash
aws rds modify-db-instance \
  --db-instance-identifier mydb \
  --max-allocated-storage 200 \
  --apply-immediately
```

---

## 6. Best Practices
- Snapshot before destructive changes.
- Encrypt at creation (KMS) when required.
- Use automated backups + retention.
- Monitor Performance Insights & Enhanced Monitoring.
- Apply least privilege IAM.
- Use parameter groups for environment-specific tuning.

---

## 7. Troubleshooting
| Issue | Cause | Fix |
|-------|-------|-----|
| Long modify time | Storage / maintenance | Schedule during window |
| Snapshot quota exceeded | Retention mismanaged | Implement lifecycle cleanup |
| Cannot stop | Unsupported engine | Verify engine capabilities |
| Slow queries | Missing logs | Enable slow query log |
| AccessDenied | IAM restrictions | Add needed `rds:Describe*` / specific actions |

Events:
```bash
aws rds describe-events --source-type db-instance --source-identifier mydb --duration 60
```

---
